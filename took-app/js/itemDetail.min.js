$(function(){var b=setInterval(function(){var c=$(".goodsopenview").width();$(".nbleft").css("max-width",c/8*1);$(".nbright").css("max-width",c/8*1);$(".nbleft").css("right",c/8*7);$(".nbright").css("left",c/8*7)},100);$(".nbleft").fadeIn(500);$(".nbright").fadeIn(600);var a=$(".goodsopenview").width();$(".allpreContainer").css("height",a)});$(function(){$("#nbmore").attr("data-id",UrlParm.parm("numIid"));$.ajax({type:"POST",url:"http://www.tooklili.com:81/tookApp/getitem/"+UrlParm.parm("id"),dataType:"json",success:function(b){if(!b.success){alert(b.message);return}var d=b.data;console.log(d);if(d==null||d.length<=0){alert("暂无数据");return}$("#big-image>img").attr("src",d.picUrl);$("#title").html(d.title);$("#couponPrice").html("￥"+d.couponPrice);$("#price").html("原价 ￥"+d.price);$("#quan").html("￥"+d.quan);$(".goodsdetail>p").html(d.intro);var c=navigator.userAgent;console.log(c);if(c.indexOf("wechat")>-1||c.indexOf("MicroMessenger")>-1){$("#one").attr("href","http://www.tooklili.com:81/taobao?backurl="+encodeURIComponent(d.quanUrl))}else{$("#one").attr("href",d.quanUrl)}$("#two").click(function(){a(d.title,d.quanUrl,d.picUrl)})},error:function(){alert("网络异常")}});function a(d,b,c){$.ajax({type:"POST",url:"http://www.tooklili.com:81/tookApp/tbk/getTPwd/",data:{text:d,url:b,logo:c},dataType:"json",success:function(e){if(!e.success){alert(e.message);return}var f=e.data;console.log(f);$("#doc-modal-1").modal({relatedTarget:this,});$("#copy_key_android").val(f);$("#copy_key_ios").html(f);$("#copybtn").attr("data-taowords",f)},error:function(){alert("网络异常")}})}});$(function(){var b=document.getElementById("copy_key_android").value;function a(){document.getElementById("copy_key_android").value=b}});$(function(){var b=1;$("#copybtn").on("click",function(){var d=$(this).attr("data-taowords");console.log(d);$("#share_content").html(d)});var a=navigator.userAgent.toLowerCase();if(b==1){$(".copy_taowords").show();var c=new Clipboard("#copybtn",{text:function(){return $(".share_content").html()}});c.on("success",function(d){$(".taokaocopy").html("<img src='../addons/bsht_tbk/res/images/copyok.png'  style='width:80%;max-width:650px'>");d.trigger.innerHTML="复制成功";d.trigger.style.backgroundColor="#9ED29E";$("#copybtn").hide();d.trigger.style.borderColor="#9ED29E";$(".share_content").hide();console.info("Action:",d.action);console.info("Text:",d.text);console.info("Trigger:",d.trigger);d.clearSelection();setTimeout(function(){$(".share").html("一键复制");$(".share").css("backgroundColor","#f54d23");$(".am-close").click()},2000)});c.on("error",function(d){d.trigger.innerHTML="复制失败";setTimeout(function(){d.trigger.innerHTML="请手工复制"},1000);d.trigger.style.backgroundColor="#666";d.trigger.style.borderColor="#9ED29E";$(".share_content").hide();console.info("Action:",d.action);console.info("Text:",d.text);console.info("Trigger:",d.trigger);d.clearSelection()})}var a=navigator.userAgent.toLowerCase();if(a.match(/iphone/i)=="iphone"||a.match(/ipad/i)=="ipad"){$(".fq-explain span").html("长按框内 > 拷贝")}else{$("#copy_key_ios").hide();$("#copy_key_android").show()}document.addEventListener("selectionchange",function(f){if(window.getSelection().anchorNode.parentNode.id=="copy_key_ios"||window.getSelection().anchorNode.id=="copy_key_ios"){var d=document.getElementById("copy_key_ios");window.getSelection().selectAllChildren(d)}},false)});$(function(){$(".nb-camera").click(function(){if($(".imgData").attr("src")==""){$(".image_loading").show();$(".image_show").hide()}$(".nb-sharecanvas").css("display","flex");$.ajax({type:"POST",url:"http://www.tooklili.com:81/tookApp/getQrCodeBase64",data:{url:window.location.href},dataType:"json",success:function(b){$("#codeimageBase64").val(b.data);a()},error:function(){alert("网络异常")}})});$(".nb-canvas .icon-close").click(function(){$(".nb-sharecanvas").css("display","none")});function a(){var c=document.getElementById("sharecanvas");var b=c.getContext("2d");b.fillStyle="#fff";c.width=(document.documentElement.clientWidth*0.9)*2;c.height=c.width/2+680;var f=b.getImageData(0,0,c.width,c.height);for(var d=0;d<f.data.length;d+=4){if(f.data[d+3]==0){f.data[d]=255;f.data[d+1]=255;f.data[d+2]=255;f.data[d+3]=255}}b.putImageData(f,0,0);var e=new Image();e.setAttribute("crossOrigin","anonymous");e.src=$("#big-image>img").attr("src");e.onerror=function(){$(".image_loading").hide();$(".image_show").hide();$(".nb-sharecanvas").hide();return false};e.onload=function(){b.drawImage(e,0,0,c.width,c.width);var g=new Image();g.setAttribute("crossOrigin","anonymous");g.src=$("#codeimageBase64").val();g.onerror=function(){$(".image_loading").hide();$(".image_show").hide();$(".nb-sharecanvas").hide();return false};g.onload=function(){b.drawImage(g,c.width-220,c.width+20,200,200);var q=$("#title").html();b.fillStyle="#605761";b.lineWidth=1;b.textAlign="left";b.textBaseline="top";b.font="28px Helvetica";var p=0;var j=c.width-60;var s=c.width+30;var h=0;for(var m=0;m<=q.length;m++){p+=b.measureText(q[m]).width;if(p>j-230){b.fillText(q.substring(h,m),20,s);
    s+=40;p=0;h=m}if(m==q.length-1){b.fillText(q.substring(h,m+1),20,s)}}var o=$("#price").html();b.fillStyle="#aba0ac";b.textAlign="left";b.font="30px Helvetica";b.textBaseline="top";b.fillText(o,20,s+30);b.strokeStyle="#aba0ac";b.lineWidth=2;b.moveTo(20,s+46);b.lineTo(200,s+46);b.stroke();var n="券后价:";b.fillStyle="#aba0ac";b.textAlign="left";b.font="30px Helvetica";b.textBaseline="top";b.fillText(n,20,s+80);var r=$("#couponPrice").html();b.fillStyle="#fba137";b.textAlign="left";b.font="42px Helvetica";b.textBaseline="top";b.fillText(r,120,s+72);b.setLineDash([10,5]);b.lineWidth=1;b.strokeStyle="#aba0ac";b.beginPath();b.moveTo(10,c.height-50);b.lineTo(c.width-10,c.height-50);b.stroke();b.fillStyle="white";b.lineWidth=0;b.beginPath();b.moveTo((c.width-308)/2-10,c.height-64);b.lineTo((c.width-308)/2+320,c.height-64);b.lineTo((c.width-308)/2+320,c.height-46);b.lineTo((c.width-308)/2-10,c.height-46);b.lineTo((c.width-308)/2-10,c.height-64);b.fill();var l="长按二维码识别查看商品";b.fillStyle="#aba0ac";b.font="28px Helvetica";b.fillText(l,(c.width-308)/2,c.height-64);var k=new Image();k.setAttribute("crossOrigin","anonymous");k.src=c.toDataURL("img/jpeg");$(".imgData").attr("background","white");$(".imgData").attr("src",k.src);$(".imgData").show();if($(".imgData").attr("src")!=""){$(".image_loading").hide();$(".image_show").show();$(".am-icon-close").show()}}}}});function gotop(){setTimeout('$("html,body").animate({scrollTop:$("body").offset().top},500);',500);$(".go-top").addClass("top-button-hide").removeClass("top-button-show")}window.addEventListener("scroll",function(a){if(document.body.scrollTop>500){$(".go-top").removeClass("top-button-hide").addClass("top-button-show")}else{$(".go-top").addClass("top-button-hide").removeClass("top-button-show")}});$(function(){$(document).delegate("#nbmore","click",function(){var a=$(this);var b=a.data("id");var c=a.attr("nbok");if(c==1){$("#tabtxt").html("商品图文详情（点击查看）");setTimeout('$("html,body").animate({scrollTop:$(".allpreContainer").offset().top},500);',500);$(".am-tab-panel").hide();$("#nbmore").attr("nbok","0");return false}$("#tabtxt").removeClass("jump");$("#nbmore").attr("nbok","1");$("#tab1").fadeIn();$("#tabtxt").html("商品图文详情（加载完毕，请您查阅）");$("#nbmore").css("text-decoration","none");setTimeout('$("html,body").animate({scrollTop:$("#tabtxtthis").offset().top},500);',500);$.ajax({url:"https://hws.m.taobao.com/cache/mtop.wdetail.getItemDescx/4.1/?data=%7Bitem_num_id%3A"+b+"%7D&type=jsonp&dataType=jsonp",dataType:"jsonp",jsonp:"callback",success:function(e){if(e.ret[0]=="SUCCESS::接口调用成功"){var d=e.data.images.length;var g=new Array();for(var f=0;f<d;f++){g[f]="<img src='"+e.data.images[f]+"' style='width:100%;max-width:100%'>"}$(".am-tab-panel").show();$(".am-tab-panel").html(g)}}})})});var code="<img style='width: 240px;height: auto;' src='./images/IMG_1543.JPG'/>";function kf(){layer.open({title:false,type:1,closeBtn:2,shadeClose:true,content:code,shade:[0.8,"#000"]});$(".layer-anim").css("position","fixed");$(".layer-anim").css("top","20%");$(".layer-anim").css("left","0");$(".layer-anim").css("right","0");$(".layer-anim").css("width","100%");$(".layer-anim").css("max-width","250px");$(".layer-anim").css("margin","auto")};