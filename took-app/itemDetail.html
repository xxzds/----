<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1" />
    <meta name="full-screen" content="yes">
    <meta name="x5-fullscreen" content="true">

    <title>优惠券详情页-促优网-专注独家正品折扣，返利-上促优，便宜购！</title>
    <meta content="促优网、返利、淘宝客、优惠券" name="keywords">
    <meta content="促优网专注独家折扣，每天精选上千款超值商品，天天更新，件件超值。商城优品超值买，优质大牌低价购，相信品牌的品质，购物就来促优网！" name="description">
    <link rel="shortcut icon" type="image/ico" href="./images/favicon.ico">
    <link rel="bookmark" href="./images/favicon.ico"/>

    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/dropload.css">
    <link rel="stylesheet" href="./css/itemDetail.css">
</head>
<body>
<!--模板 img标签注意，防止浏览器加载一次模板中的src，报错-->
<div id="template" style="display: none">
    &lt;img src="${smallImage}"&gt;
</div>

<!--content-->
<div class="container-fluid">
    <div>
        <div id="big-image"><img src=""></div>
        <div id="title"><span></span></div>
        <div id="couponPrice">券后包邮<span></span></div>
    </div>


    <div>
        现价<span id="price"></span>
        优惠券<span id="quan"></span>
        销量<span id="volume"></span>

    </div>

    <!--图片-->
    <div id="detailItem">
        商品详情
    </div>
    <div id="images"></div>

    <!--footer-->
    <div class="footer">
        <a id="one">直接购买</a>
        <a id="two">淘口令分享</a>
    </div>
</div>





<script type="text/javascript" src="./js/jquery.min.js"></script>
<!--<script type="text/javascript" src="./js/jquery.cookie.js"></script>-->
<script type="text/javascript"  src="./js/getUrlParam.js"></script>
<script type="text/javascript">
    $(function() {
        $.ajax({
            type: "POST",
            url: "http://www.tooklili.com:81/tookApp/getitem/" + UrlParm.parm("id"),
            dataType: "json",
            success: function (result) {

                if(!result.success){
                    alert(result.message);
                    return;
                }
                var data = result.data;
                console.log(data);
                if(data==null || data.length<=0) {
                    alert("暂无数据");
                    return;
                }

                //主图
                $('#big-image>img').attr("src",data.picUrl);
                //标题
                $('#title>span').html(data.title);
                //券后价
                $('#couponPrice>span').html(data.couponPrice);
                //现价
                $('#price').html(data.price);
                //优惠券
                $('#quan').html(data.quan);
                //销量
                $('#volume').html(data.volume);
                //直接购买
                $('.footer>#one').attr('href',data.quanUrl);

                //淘口令分享
                $('.footer>#two').click(function () {
                    getTpwd(data.title,data.quanUrl)
                    
                });

            },
            error: function () {
                alert("网络异常");
            }
        });
        
        
        function getTpwd(text,url) {
            $.ajax({
                type: "POST",
                url: "http://www.tooklili.com:81/tookApp/tbk/getTPwd/",
                data:{
                    text:text,
                    url:url
                },
                dataType: "json",
                success: function (result) {

                    if(!result.success){
                        alert(result.message);
                        return;
                    }
                    var data = result.data;
                    console.log(data);

                },
                error: function () {
                    alert("网络异常");
                }
            });
        }




        $.ajax({
            type: "POST",
            url: "http://www.tooklili.com:81/tookApp/tbk/getItemDetail/" + UrlParm.parm("numIid"),
            dataType: "json",
            success: function (result) {

                if(!result.success){
                    alert(result.message);
                    return;
                }
                var data = result.data;
                console.log(data);
                if(data==null || data.length<=0) {
                    alert("暂无数据");
                    return;
                }

                //图片列表
                var template=$('#template').html();
                var html="";
                var smallImages = data.smallImages;
                for(var i=0;i<smallImages.length;i++){
                    html+=template.replace("${smallImage}",smallImages[i])
                        .replace("&lt;","<")
                        .replace("&gt;",">");
                }
                $('#images').html(html);

            },
            error: function () {
                alert("网络异常");
            }
        });



        $('#detailItem').click(function(){
            $('#images').slideToggle();
        })


    });

</script>
</body>
</html>